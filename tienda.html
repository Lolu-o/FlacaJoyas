<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tienda ‚Äî Las Flacas Joyas</title>
  <link rel="stylesheet" href="Estilos.css">
</head>

<body>
  <header class="topbar">
    <div class="container nav">
      <a class="brand" href="index.html" aria-label="Ir al inicio">
        <span>LA&nbsp;FLACA&nbsp;JOYAS¬Æ</span>
      </a>

      <div class="search">
        <input id="q" placeholder="Buscar aros, collares..." aria-label="Buscar">
        <a class="btn" href="carrito.html" aria-label="Ver carrito" style="padding: 0 12px; font-size: 1.2rem;">üõí</a>
      </div>

      <nav class="menu" aria-label="Principal">
        <a href="tienda.html">Tienda</a>
        <a href="colecciones.html">Colecciones</a>
        <a href="blog.html">Blog</a>
        <a href="ayuda.html">Ayuda</a>
        <a href="nosotros.html">Nosotros</a>
      </nav>

      <a href="cuenta.html" class="icon-btn icon-user" aria-label="Abrir cuenta">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="7" r="4"></circle>
          <path d="M5.5 21a6.5 6.5 0 0 1 13 0"></path>
        </svg>
      </a>
    </div>
  </header>

  <main class="container">
    <h1 class="h1">Cat√°logo</h1>
    <div class="filters">
      <select id="f-cat" class="select">
        <option value="">Categor√≠a</option>
        <option value="aros">Aros</option>
        <option value="argollas">Argollas</option>
        <option value="collares">Collares</option>
      </select>
      <select id="f-mat" class="select">
        <option value="">Material</option>
        <option value="arcilla">Arcilla polim√©rica</option>
      </select>

      <select id="f-size" class="select">
        <option value="">Tama√±o</option>
        <option value="pequeno">Peque√±o</option>
        <option value="mediano">Mediano</option>
        <option value="grande">Grande</option>
      </select>
      <select id="f-sort" class="select">
        <option value="">Ordenar</option>
        <option value="top">M√°s vendidos</option>
        <option value="new">Nuevos</option>
        <option value="price-asc">Precio ‚Üë</option>
        <option value="price-desc">Precio ‚Üì</option>
      </select>
      <select id="f-precio" class="select">
        <option value="">Precio m√°x.</option>
        <option value="15000">$15.000</option>
        <option value="20000">$20.000</option>
        <option value="30000">$30.000</option>
      </select>
    </div>
    <div id="list" class="grid-4"></div>
  </main>

  <div class="toast"></div>
  <footer class="footer">
    <div class="container footer-grid">
      <div><strong>Las Flacas Joyas</strong>
        <p class="muted">Dise√±os √∫nicos en arcilla polim√©rica. Hecho a mano en Chile.</p>
      </div>
      <div>
        <small class="muted">Ayuda</small><br>
        <a href="ayuda.html">Env√≠os y devoluciones</a><br>
        <a href="politicas.html">Pol√≠ticas</a>
      </div>
      <div>
        <small class="muted">Contacto</small><br>
        <a href="contacto.html">Formulario & WhatsApp</a>
      </div>
      <div>
        <small class="muted">Cuenta</small><br>
        <a href="cuenta.html">Ingresar / Registro</a><br>
        <a href="wishlist.html">Wishlist</a> 
      </div>
    </div>
</footer>
  <script src="app.js"></script>
  <script>
    const params = new URL(location.href).searchParams;
    document.getElementById('q').value = params.get('q') || '';

    function render() {
      const prods = listProducts({
        categoria: document.getElementById('f-cat').value || params.get('categoria'),
        material: document.getElementById('f-mat').value || params.get('material'),
        size: document.getElementById('f-size').value || params.get('size'), // <-- CAMBIO AQU√ç
        precioMax: document.getElementById('f-precio').value || params.get('precio'),
        sort: document.getElementById('f-sort').value || params.get('sort'),
        q: document.getElementById('q').value || params.get('q')
      });

      const list = document.getElementById('list');
      list.innerHTML = prods.map(p => {

        const imgUrl = (p.media && p.media.length > 0) ? p.media[0].url : 'assets/placeholder.jpg';
        const imgAlt = (p.media && p.media.length > 0) ? p.media[0].alt : p.nombre;
        return `
      <a class="card product-card" href="producto.html?slug=${p.slug}">
        
        <img class="product-card-img" src="${imgUrl}" alt="${imgAlt}" loading="lazy">
        
        <div class="row" style="justify-content:space-between">
          <strong>${p.nombre}</strong> <span class="tag">${p.material}</span>
        </div>
        <div class="price">${money(p.precio)}</div>
      </a>
    `}).join('') || '<p class="muted">Sin resultados.</p>';
    }

    // v CAMBIO AQU√ç v
    ['f-cat', 'f-mat', 'f-precio', 'f-sort', 'f-size'].forEach(id => document.getElementById(id).addEventListener('change', render));
    // ^ CAMBIO AQU√ç ^
    document.getElementById('q').addEventListener('keydown', (e) => { if (e.key === 'Enter') render(); });
    render();
  </script>
</body>

</html>